2025-11-13 21:30:37 - OTMS - ERROR - Dashboard PDF rendering failed
Traceback (most recent call last):
  File "C:\Users\Praveen\Documents\Project OTMS\oil_app_ui.py", line 3688, in <module>
    pdf_bytes = _render_dashboard_pdf_bytes(html_str)
  File "C:\Users\Praveen\Documents\Project OTMS\oil_app_ui.py", line 3640, in _render_dashboard_pdf_bytes
    return asyncio.run(asyncio.wait_for(_convert(), timeout=timeout))
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\tasks.py", line 507, in wait_for
    return await fut
           ^^^^^^^^^
  File "C:\Users\Praveen\Documents\Project OTMS\oil_app_ui.py", line 3618, in _convert
    browser = await launch(
              ^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Praveen\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pyppeteer\launcher.py", line 307, in launch
    return await Launcher(options, **kwargs).launch()
                 ~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Praveen\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pyppeteer\launcher.py", line 120, in __init__
    download_chromium()
    ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Praveen\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pyppeteer\chromium_downloader.py", line 138, in download_chromium
    extract_zip(download_zip(get_url()), DOWNLOADS_FOLDER / REVISION)
                ~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Praveen\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0\LocalCache\local-packages\Python313\site-packages\pyppeteer\chromium_downloader.py", line 82, in download_zip
    raise OSError(f'Chromium downloadable not found at {url}: ' f'Received {r.data.decode()}.\n')
OSError: Chromium downloadable not found at https://storage.googleapis.com/chromium-browser-snapshots/Win_x64/1181205/chrome-win.zip: Received <?xml version='1.0' encoding='UTF-8'?><Error><Code>NoSuchKey</Code><Message>The specified key does not exist.</Message><Details>No such object: chromium-browser-snapshots/Win_x64/1181205/chrome-win.zip</Details></Error>.

2025-11-13 21:32:19 - OTMS - ERROR - Dashboard PDF rendering failed
Traceback (most recent call last):
  File "C:\Users\Praveen\Documents\Project OTMS\oil_app_ui.py", line 3719, in <module>
    pdf_bytes = _render_dashboard_pdf_bytes(html_str)
  File "C:\Users\Praveen\Documents\Project OTMS\oil_app_ui.py", line 3671, in _render_dashboard_pdf_bytes
    return asyncio.run(asyncio.wait_for(_convert(), timeout=timeout))
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\tasks.py", line 507, in wait_for
    return await fut
           ^^^^^^^^^
  File "C:\Users\Praveen\Documents\Project OTMS\oil_app_ui.py", line 3659, in _convert
    await page.setContent(html_payload, waitUntil="networkidle0")
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Page.setContent() got an unexpected keyword argument 'waitUntil'
2025-11-13 21:33:09 - OTMS - ERROR - Dashboard PDF rendering failed
Traceback (most recent call last):
  File "C:\Users\Praveen\Documents\Project OTMS\oil_app_ui.py", line 3719, in <module>
    pdf_bytes = _render_dashboard_pdf_bytes(html_str)
  File "C:\Users\Praveen\Documents\Project OTMS\oil_app_ui.py", line 3671, in _render_dashboard_pdf_bytes
    return asyncio.run(asyncio.wait_for(_convert(), timeout=timeout))
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\tasks.py", line 507, in wait_for
    return await fut
           ^^^^^^^^^
  File "C:\Users\Praveen\Documents\Project OTMS\oil_app_ui.py", line 3659, in _convert
    await page.setContent(html_payload, {"waitUntil": "networkidle0"})
          ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Page.setContent() takes 2 positional arguments but 3 were given
2025-11-13 21:35:32 - OTMS - ERROR - Dashboard PDF rendering failed
Traceback (most recent call last):
  File "C:\Users\Praveen\Documents\Project OTMS\oil_app_ui.py", line 3720, in <module>
    pdf_bytes = _render_dashboard_pdf_bytes(html_str)
  File "C:\Users\Praveen\Documents\Project OTMS\oil_app_ui.py", line 3672, in _render_dashboard_pdf_bytes
    return asyncio.run(asyncio.wait_for(_convert(), timeout=timeout))
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.2544.0_x64__qbz5n2kfra8p0\Lib\asyncio\tasks.py", line 507, in wait_for
    return await fut
           ^^^^^^^^^
  File "C:\Users\Praveen\Documents\Project OTMS\oil_app_ui.py", line 3660, in _convert
    await page.waitForTimeout(500)
          ^^^^^^^^^^^^^^^^^^^
AttributeError: 'Page' object has no attribute 'waitForTimeout'
